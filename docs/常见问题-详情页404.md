# 常见问题：详情页 404

## 问题描述

访问日报详情页时出现 404 错误，例如：
- `https://enneket.github.io/daily/docs/2026/02/12.html`

## 可能的原因

### 1. 浏览器缓存

最常见的原因是浏览器缓存了旧的 404 页面。

**解决方法**：
- 按 `Ctrl + F5`（Windows）或 `Cmd + Shift + R`（Mac）强制刷新
- 或者清除浏览器缓存后重新访问
- 或者使用无痕模式/隐私模式访问

### 2. GitHub Pages 构建未完成

GitHub Actions 需要时间来构建和部署网站。

**检查方法**：
1. 访问仓库的 Actions 页面：`https://github.com/你的用户名/仓库名/actions`
2. 查看最新的 workflow 运行状态
3. 确认 "部署日报展示网站" workflow 已成功完成（绿色勾）

**等待时间**：
- 通常需要 2-5 分钟
- 如果日报很多，可能需要更长时间

### 3. 日报文件位置错误

日报文件必须在 `site/docs/` 目录下，而不是 `docs/` 目录。

**检查方法**：
1. 访问仓库：`https://github.com/你的用户名/仓库名`
2. 查看文件结构，确认日报在 `site/docs/YYYY/MM/DD.md`
3. 如果在 `docs/` 目录，需要迁移（使用 v1.2.3 或更高版本自动迁移）

### 4. VitePress 配置问题

VitePress 的 base 路径必须与仓库名匹配。

**检查方法**：
1. 打开 `site/.vitepress/config.ts`
2. 确认 `base: '/仓库名/'`（注意前后的斜杠）
3. 例如仓库名是 `daily`，则应该是 `base: '/daily/'`

### 5. GitHub Pages 未启用

GitHub Pages 必须正确配置。

**检查方法**：
1. 进入仓库 Settings → Pages
2. 确认 Source 设置为 "GitHub Actions"
3. 确认显示网站地址：`https://你的用户名.github.io/仓库名/`

## 诊断步骤

### 步骤 1：确认文件位置

访问：`https://github.com/你的用户名/仓库名/tree/main/site/docs/2026/02`

- ✅ 如果能看到 `12.md` 文件，说明文件位置正确
- ❌ 如果看不到，说明文件还在旧位置，需要迁移

### 步骤 2：确认构建状态

访问：`https://github.com/你的用户名/仓库名/actions`

- ✅ 最新的 workflow 显示绿色勾，说明构建成功
- ❌ 显示红色叉或黄色圆圈，说明构建失败或进行中

### 步骤 3：测试访问

使用无痕模式访问：`https://你的用户名.github.io/仓库名/docs/2026/02/12`

- ✅ 能看到日报内容，说明网站正常，是缓存问题
- ❌ 仍然 404，继续下一步

### 步骤 4：检查 URL 格式

VitePress 支持两种 URL 格式：
- `https://你的用户名.github.io/仓库名/docs/2026/02/12` （推荐）
- `https://你的用户名.github.io/仓库名/docs/2026/02/12.html`

两种都应该可以访问。

### 步骤 5：查看构建日志

如果构建失败：
1. 点击失败的 workflow
2. 查看 "build" 步骤的日志
3. 查找错误信息

常见错误：
- `ENOENT: no such file or directory` - 文件路径错误
- `Parse error` - Markdown 语法错误
- `Module not found` - 依赖缺失

## 解决方案

### 方案 1：清除缓存（最常见）

```bash
# 强制刷新
Ctrl + F5 (Windows)
Cmd + Shift + R (Mac)
```

### 方案 2：迁移文件（如果文件在旧位置）

使用桌面应用 v1.2.3 或更高版本：
1. 打开应用
2. 点击"保存并初始化"
3. 应用会自动迁移文件

或手动迁移：
```bash
# 在日报仓库中执行
mkdir -p site/docs
cp -r docs/* site/docs/
rm -rf docs
git add .
git commit -m "Migrate reports to site/docs/"
git push
```

### 方案 3：等待构建完成

如果 GitHub Actions 正在运行：
1. 等待构建完成（通常 2-5 分钟）
2. 刷新页面

### 方案 4：重新触发构建

如果构建失败：
1. 访问 Actions 页面
2. 点击失败的 workflow
3. 点击右上角 "Re-run all jobs"

或者提交一个空 commit：
```bash
git commit --allow-empty -m "Trigger rebuild"
git push
```

### 方案 5：修复配置

如果 base 路径错误：
1. 编辑 `site/.vitepress/config.ts`
2. 修改 `base: '/正确的仓库名/'`
3. 提交并推送

## 验证成功

访问以下 URL，都应该能看到内容：
- 首页：`https://你的用户名.github.io/仓库名/`
- 日历：`https://你的用户名.github.io/仓库名/calendar`
- 详情：`https://你的用户名.github.io/仓库名/docs/2026/02/12`

## 预防措施

1. **使用最新版本**：确保桌面应用是 v1.2.3 或更高版本
2. **检查构建**：每次提交后检查 GitHub Actions 是否成功
3. **测试访问**：提交后等待几分钟，然后测试访问
4. **清除缓存**：遇到问题时首先尝试清除缓存

## 仍然无法解决？

如果以上方法都无法解决，请提供以下信息：
1. 仓库地址
2. 访问的 URL
3. GitHub Actions 构建日志
4. 浏览器控制台错误信息（F12 → Console）
5. 桌面应用版本号

## 相关文档

- [v1.2.3 自动迁移日报文件](./v1.2.3自动迁移日报文件.md)
- [v1.2.2 修复日报详情页 404 问题](./v1.2.2修复日报详情页404问题.md)
- [完整使用流程](./完整使用流程.md)
- [启用 GitHub Pages](./启用GitHub-Pages.md)
