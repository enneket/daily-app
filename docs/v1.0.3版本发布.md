# v1.0.3 版本发布

## 发布信息

- **版本号**：v1.0.3
- **发布日期**：2026-02-24
- **版本类型**：功能优化

## 更新内容

### 🗑️ 移除功能

#### 移除日历视图模块

**变更说明**：
移除了日报网站中的日历视图模块，简化网站结构和维护成本。

**移除的文件**：
- `site/calendar.md` - 日历视图页面
- `site/calendar-simple.md` - 简化版日历
- `site/calendar-complex.md.bak` - 备份文件

**替代方案**：
用户可以通过以下方式查看日报：
1. **归档页面** (`/archive`)：按日期列表显示所有日报
2. **统计页面** (`/stats`)：查看日报统计信息
3. **搜索功能**：全文搜索日报内容
4. **最新页面** (`/latest`)：查看最新的日报

### 🔄 变更内容

#### 1. 更新配置同步版本

- 同步版本从 v1.2.7 升级到 v1.0.3
- 统一版本号体系，符合语义化版本规范

#### 2. 优化网站导航

- 导航栏移除"日历"链接
- 保留"首页"、"归档"、"统计"三个核心功能

#### 3. 更新首页按钮

- 将"日历视图"按钮改为"归档浏览"
- 更直观地引导用户使用归档功能

### ✨ 改进优化

#### 1. 增强自动清理机制

新增 `cleanupRemovedFiles()` 函数，自动清理用户仓库中的废弃文件：

```typescript
private async cleanupRemovedFiles(): Promise<void> {
  const removedFiles = [
    'site/calendar.md',
    'site/calendar-simple.md',
    'site/calendar-complex.md.bak'
  ];
  
  // 自动检测并删除这些文件
}
```

**工作流程**：
1. 用户保存配置时触发
2. 检查仓库中是否存在废弃文件
3. 自动删除找到的废弃文件
4. 记录清理日志

#### 2. 优化配置同步流程

**同步流程**：
```
保存配置 → 检查版本 → 对比文件 → 增量更新 → 清理废弃文件 → 更新版本记录
```

**优势**：
- 增量更新，只更新变化的文件
- 自动清理，无需手动操作
- 版本追踪，可查看每个文件的版本

## 技术改进

### 1. 版本管理优化

```typescript
// 更新版本号
CURRENT_VERSION = '1.0.3'

// 更新文件版本映射
FILE_VERSIONS = {
  'site/.vitepress/config.ts': '1.0.3',
  'site/index.md': '1.0.3',
  // 移除了 'site/calendar.md'
  ...
}
```

### 2. 文件同步列表更新

```typescript
const filesToCopy = [
  // 移除了 calendar.md
  { local: 'site/index.md', remote: 'site/index.md' },
  { local: 'site/archive.md', remote: 'site/archive.md' },
  { local: 'site/stats.md', remote: 'site/stats.md' },
  { local: 'site/latest.md', remote: 'site/latest.md' },
  ...
];
```

### 3. 自动清理实现

- 检测废弃文件是否存在
- 获取文件 SHA 用于删除
- 执行删除操作
- 记录清理结果

## 升级指南

### 从 v1.0.2 升级

1. **下载最新版本**
   - 从 [Releases](https://github.com/enneket/daily-app/releases) 下载 v1.0.3

2. **安装更新**
   - 运行安装程序（会自动覆盖旧版本）
   - 配置会自动保留

3. **自动同步**
   - 首次打开应用时，会自动检测版本
   - 保存配置时，会自动更新仓库文件
   - 自动清理旧的日历文件

### 配置迁移

无需手动操作，应用会自动处理：
- ✅ 更新网站配置文件
- ✅ 更新首页内容
- ✅ 删除日历相关文件
- ✅ 更新版本记录

## 用户影响

### 功能变化

- ❌ 无法通过日历视图查看日报
- ✅ 可以通过归档页面按日期浏览
- ✅ 可以通过统计页面查看数据
- ✅ 可以使用搜索功能查找日报

### 使用体验

- 网站结构更简洁
- 导航更清晰
- 加载速度更快
- 维护成本更低

## 已知问题

无

## 测试建议

### 功能测试

1. **配置同步测试**
   - 保存配置
   - 检查仓库是否更新
   - 验证旧文件是否被删除

2. **网站功能测试**
   - 访问日报网站
   - 检查导航栏（无日历链接）
   - 测试归档功能
   - 测试统计功能

3. **日报功能测试**
   - 编写日报
   - 提交日报
   - 查看日报

### 回归测试

- [ ] 日报编辑功能正常
- [ ] GitHub 配置保存正常
- [ ] 日报提交功能正常
- [ ] 日报读取功能正常
- [ ] 单实例锁定正常
- [ ] 图标显示正常

## 下载

### Windows

- 安装包：`DailyReport-Setup-1.0.3.exe`
- 便携版：`DailyReport-1.0.3-win.zip`

### macOS

- DMG 安装包：`DailyReport-1.0.3.dmg`

### Linux

- AppImage：`DailyReport-1.0.3.AppImage`
- Deb 包：`daily-report-app_1.0.3_amd64.deb`

## 反馈

如有问题或建议，请通过以下方式反馈：
- GitHub Issues
- 邮箱：zhao.jiaxing@qq.com

## 致谢

感谢所有用户的反馈和支持！

---

**完整更新日志**：
- v1.0.3: 移除日历视图，优化配置同步
- v1.0.2: 图标修复与单实例锁定
- v1.0.1: 修复版
- v1.0.0: 正式版本发布
