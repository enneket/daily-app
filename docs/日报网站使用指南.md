# 日报网站使用指南

## 概述

日报仓库现在包含了一个完整的展示网站功能，可以将你的日报自动生成为美观的网页，并通过 GitHub Pages 发布。

## 项目结构

```
daily/                          # 日报仓库
├── 2026/                       # 日报文件
│   └── 02/
│       └── 11.md
├── site/                       # 网站源码
│   ├── .vitepress/
│   │   ├── config.ts          # 网站配置
│   │   ├── reports-index.data.ts
│   │   └── stats.data.ts
│   ├── index.md               # 首页
│   ├── calendar.md            # 日历视图
│   ├── archive.md             # 归档页面
│   ├── stats.md               # 统计页面
│   └── latest.md              # 最新日报
├── scripts/
│   └── generate-index.js      # 索引生成脚本
├── .github/
│   └── workflows/
│       └── deploy-site.yml    # 自动部署
└── package.json
```

## 快速开始

### 1. 安装依赖

```bash
npm install
```

这会安装 VitePress 和其他必要的依赖。

### 2. 本地预览

```bash
# 生成索引
node scripts/generate-index.js

# 启动开发服务器
npm run dev:site
```

访问 http://localhost:5173 查看网站效果。

### 3. 构建网站

```bash
# 生成索引
node scripts/generate-index.js

# 构建静态网站
npm run build:site
```

构建后的文件在 `site/.vitepress/dist/` 目录。

## 自动部署

### 配置 GitHub Pages

1. **启用 GitHub Pages**
   - 进入仓库 Settings → Pages
   - Source 选择 "GitHub Actions"
   - 保存

2. **推送代码**
   ```bash
   git add .
   git commit -m "添加日报网站"
   git push
   ```

3. **自动构建**
   - 每次推送日报文件（.md）时自动触发构建
   - 约 2-3 分钟后网站更新完成

4. **访问网站**
   ```
   https://你的用户名.github.io/daily/
   ```

### 工作流程

```
提交日报 (git push)
    ↓
触发 GitHub Actions
    ↓
运行 generate-index.js (生成索引)
    ↓
运行 vitepress build (构建网站)
    ↓
部署到 GitHub Pages
    ↓
网站自动更新
```

## 网站功能

### 首页
- 显示统计卡片（总数、连续天数、本月日报、平均字数）
- 显示最近 10 篇日报
- 每篇日报显示日期、标题、摘要、时间点

### 日历视图
- 月历展示，标记有日报的日期
- 点击日期跳转到对应日报
- 支持月份切换
- "回到今天"快捷按钮

### 归档页面
- 按年份和月份筛选
- 按月分组显示所有日报
- 显示日期、标题、摘要、字数、时间点数量

### 统计页面
- 总体统计（总数、连续天数、今年/本月日报、总字数、平均字数）
- 时间跨度（第一篇到最新一篇）
- 本月完成率进度条
- 按年份统计柱状图
- 最近 12 个月统计
- 记录（最长/最短日报）

### 搜索功能
- 全文搜索（VitePress 内置）
- 支持中文搜索
- 实时搜索结果

## 自定义配置

### 修改网站标题和描述

编辑 `site/.vitepress/config.ts`：

```typescript
export default defineConfig({
  title: '我的日报',           // 修改标题
  description: '记录每一天的成长',  // 修改描述
  base: '/daily/',            // 修改为你的仓库名
  
  themeConfig: {
    socialLinks: [
      { icon: 'github', link: 'https://github.com/你的用户名/daily' }
    ]
  }
});
```

### 修改 base 路径

如果你的仓库名不是 `daily`，需要修改 `base` 配置：

```typescript
// 仓库名为 my-reports
base: '/my-reports/',

// 仓库名为 daily-reports
base: '/daily-reports/',
```

### 添加 Logo

1. 将 logo 文件放到 `site/public/logo.svg`
2. 在配置中引用：

```typescript
themeConfig: {
  logo: '/logo.svg'
}
```

## 日报格式要求

为了网站能正确解析日报，请遵循以下格式：

```markdown
# 2026-02-11 日报

## 10:30
- 完成了功能 A
- 修复了 Bug B

## 14:20
- 参加了会议
- 更新了文档

## 17:00
- 代码审查
```

**格式说明**：
- 第一行：`# YYYY-MM-DD 日报` 作为标题
- 时间标记：`## HH:MM` 格式
- 内容：时间标记下的所有内容

## 常见问题

### Q: 网站没有更新？

A: 检查以下几点：
1. GitHub Actions 是否运行成功（查看 Actions 标签）
2. GitHub Pages 是否启用
3. 等待 2-3 分钟让部署完成

### Q: 网站显示 404？

A: 检查 `site/.vitepress/config.ts` 中的 `base` 配置是否正确。

### Q: 搜索功能不工作？

A: VitePress 的搜索功能需要构建后才能使用，本地开发时可能不可用。

### Q: 如何添加自定义页面？

A: 在 `site/` 目录下创建新的 `.md` 文件，然后在 `config.ts` 的 `nav` 中添加链接。

### Q: 如何修改样式？

A: 在 `site/.vitepress/theme/` 目录下创建自定义样式文件。

## 手动触发部署

如果需要手动触发部署：

1. 进入仓库的 Actions 标签
2. 选择 "部署日报展示网站" workflow
3. 点击 "Run workflow"
4. 选择分支（通常是 main）
5. 点击 "Run workflow" 按钮

## 本地开发

### 开发网站

```bash
# 生成索引
node scripts/generate-index.js

# 启动开发服务器
npm run dev:site
```

### 预览构建结果

```bash
# 构建
npm run build:site

# 预览
npm run preview:site
```

## 性能优化

### 构建速度
- 首次构建：约 30-60 秒
- 增量构建：约 10-20 秒

### 网站性能
- 完全静态，加载速度快
- 支持代码分割
- 自动优化图片
- CDN 加速（GitHub Pages）

## 扩展功能

### 添加评论系统

可以集成 Giscus（基于 GitHub Discussions）：

1. 安装依赖：
   ```bash
   npm install @giscus/vue
   ```

2. 在页面中添加评论组件

### 添加 RSS 订阅

可以生成 RSS feed 供读者订阅。

### 添加统计分析

可以集成 Google Analytics 或其他统计工具。

## 维护

### 定期检查
- 检查 GitHub Actions 运行状态
- 检查网站访问是否正常
- 更新依赖包（每月一次）

### 更新依赖

```bash
# 检查过时的包
npm outdated

# 更新所有包
npm update

# 更新 VitePress
npm install vitepress@latest
```

## 故障排除

### Actions 失败

查看 Actions 日志，常见问题：
- 权限不足：检查 GitHub Pages 权限
- 构建错误：检查日报格式是否正确
- 依赖问题：尝试清除缓存重新构建

### 网站显示异常

1. 清除浏览器缓存
2. 检查控制台错误信息
3. 检查 `base` 配置是否正确

## 总结

现在你的日报仓库具备了完整的网站功能：
- ✅ 自动生成索引
- ✅ 美观的展示界面
- ✅ 日历和归档视图
- ✅ 统计和搜索功能
- ✅ 自动部署到 GitHub Pages

只需专注于写日报，网站会自动更新！
