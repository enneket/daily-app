# v1.2.8 ä¿®å¤çª—å£å›¾æ ‡æ˜¾ç¤ºé—®é¢˜

## ä¿®å¤å†…å®¹

ä¿®å¤äº†åº”ç”¨çª—å£æ ‡é¢˜æ å’Œä»»åŠ¡æ ä¸­å›¾æ ‡æ˜¾ç¤ºä¸æ­£ç¡®çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯ Windows å¹³å°çš„å›¾æ ‡æ˜¾ç¤ºã€‚

## é—®é¢˜æè¿°

åœ¨å¼€å‘æ¨¡å¼å’Œæ‰“åŒ…åçš„åº”ç”¨ä¸­ï¼Œçª—å£æ ‡é¢˜æ å’Œä»»åŠ¡æ æ˜¾ç¤ºçš„æ˜¯é€šç”¨æ–‡æ¡£å›¾æ ‡ï¼ˆğŸ“„ï¼‰ï¼Œè€Œä¸æ˜¯è‡ªå®šä¹‰çš„åº”ç”¨å›¾æ ‡ã€‚è¯¥é—®é¢˜åœ¨ Windows å’Œ Linux å¹³å°ä¸Šéƒ½å­˜åœ¨ã€‚

## ä¿®å¤æ–¹æ¡ˆ

### 1. ä¼˜åŒ–å›¾æ ‡è·¯å¾„é€»è¾‘

ä¿®æ”¹äº† `src/main/main.ts` ä¸­çš„å›¾æ ‡è·¯å¾„è®¡ç®—é€»è¾‘ï¼š

- **å¼€å‘æ¨¡å¼**ï¼šä½¿ç”¨ `path.resolve()` è·å–ç»å¯¹è·¯å¾„ï¼Œç¡®ä¿è·¯å¾„æ­£ç¡®
- **ç”Ÿäº§æ¨¡å¼**ï¼šä»æ‰“åŒ…åçš„ `resources` ç›®å½•è¯»å–å›¾æ ‡
- **å¹³å°é€‚é…**ï¼š
  - Windows: ä½¿ç”¨ `.ico` æ ¼å¼
  - macOS: ä½¿ç”¨ `.icns` æ ¼å¼
  - Linux: ä½¿ç”¨ `.png` æ ¼å¼

### 2. ä½¿ç”¨ nativeImage åŠ è½½å›¾æ ‡

æ”¹ç”¨ Electron çš„ `nativeImage` API æ¥åŠ è½½å›¾æ ‡ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨æ–‡ä»¶è·¯å¾„ï¼š

```typescript
const icon = nativeImage.createFromPath(iconPath);
mainWindow = new BrowserWindow({
  icon: icon,  // ä½¿ç”¨ nativeImage å¯¹è±¡
  // ...
});
```

### 3. å¹³å°ç‰¹æ®Šå¤„ç†

åœ¨ Windows å’Œ Linux ç³»ç»Ÿä¸Šï¼Œéœ€è¦é¢å¤–è°ƒç”¨ `setIcon` æ–¹æ³•æ¥ç¡®ä¿å›¾æ ‡æ­£ç¡®æ˜¾ç¤ºï¼š

```typescript
if (process.platform === 'linux') {
  mainWindow.setIcon(icon);
} else if (process.platform === 'win32') {
  mainWindow.setIcon(icon);
}
```

### 4. æ·»åŠ çª—å£æ ‡é¢˜

æ˜¾å¼è®¾ç½®çª—å£æ ‡é¢˜ä¸º"æ—¥æŠ¥åŠ©æ‰‹"ï¼Œç¡®ä¿åº”ç”¨åç§°æ­£ç¡®æ˜¾ç¤ºã€‚

### 5. å¢å¼ºè°ƒè¯•æ—¥å¿—

æ·»åŠ äº†è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼š
- å¹³å°ä¿¡æ¯
- å›¾æ ‡è·¯å¾„
- æ–‡ä»¶å­˜åœ¨æ€§
- å›¾æ ‡åŠ è½½çŠ¶æ€
- å›¾æ ‡å°ºå¯¸

## æŠ€æœ¯ç»†èŠ‚

```typescript
// å¯¼å…¥ nativeImage
const { app, BrowserWindow, ipcMain, nativeImage } = require('electron');

// å¼€å‘æ¨¡å¼ä½¿ç”¨ç»å¯¹è·¯å¾„
if (process.env.NODE_ENV === 'development') {
  const projectRoot = path.resolve(__dirname, '../..');
  iconPath = path.join(projectRoot, 'build/icon.ico');
}

// åŠ è½½å›¾æ ‡
const icon = nativeImage.createFromPath(iconPath);
console.log('Icon loaded:', !icon.isEmpty());
console.log('Icon size:', icon.getSize());

// åˆ›å»ºçª—å£æ—¶ä½¿ç”¨ nativeImage å¯¹è±¡
mainWindow = new BrowserWindow({
  icon: icon,
  // ...
});

// Windows å’Œ Linux å¹³å°é¢å¤–è®¾ç½®
if (process.platform === 'win32' || process.platform === 'linux') {
  mainWindow.setIcon(icon);
}
```

## å½±å“èŒƒå›´

- çª—å£æ ‡é¢˜æ å›¾æ ‡æ˜¾ç¤º
- ä»»åŠ¡æ /Dock å›¾æ ‡æ˜¾ç¤º
- åº”ç”¨åˆ‡æ¢å™¨ä¸­çš„å›¾æ ‡æ˜¾ç¤º
- Windows ä»»åŠ¡æ é¢„è§ˆå›¾æ ‡

## æµ‹è¯•å»ºè®®

1. å¼€å‘æ¨¡å¼æµ‹è¯•ï¼š`npm run dev:electron`
   - æ£€æŸ¥æ§åˆ¶å°è¾“å‡ºçš„å›¾æ ‡åŠ è½½ä¿¡æ¯
   - ç¡®è®¤å›¾æ ‡è·¯å¾„å­˜åœ¨ä¸”åŠ è½½æˆåŠŸ
2. æ‰“åŒ…åæµ‹è¯•ï¼š
   - Windows: `npm run package:win`
   - macOS: `npm run package:mac`
   - Linux: `npm run package:linux`

## ç‰ˆæœ¬ä¿¡æ¯

- ç‰ˆæœ¬å·ï¼šv1.2.8
- å‘å¸ƒæ—¥æœŸï¼š2026-02-24
