# 日报仓库快速设置

## 一键设置脚本

将以下文件复制到你的日报仓库即可。

## 步骤 1：创建日报仓库

在 GitHub 上创建一个新仓库，例如 `daily-reports`。

## 步骤 2：克隆并初始化

```bash
git clone https://github.com/你的用户名/daily-reports.git
cd daily-reports
```

## 步骤 3：复制必要文件

从桌面应用仓库复制以下文件到日报仓库：

```bash
# 假设桌面应用仓库在 ../daily-app
cp -r ../daily-app/site ./
cp -r ../daily-app/scripts ./
```

## 步骤 4：创建配置文件

### 创建 package.json

```json
{
  "name": "daily-reports",
  "version": "1.0.0",
  "description": "我的日报",
  "scripts": {
    "build:site": "vitepress build site",
    "dev:site": "vitepress dev site",
    "preview:site": "vitepress preview site"
  },
  "devDependencies": {
    "fs-extra": "^11.2.0",
    "vitepress": "^1.0.0"
  }
}
```

### 创建 .gitignore

```
node_modules
site/.vitepress/dist
site/.vitepress/cache
site/.vitepress/reports-index.json
site/.vitepress/stats.json
.DS_Store
```

### 创建 .github/workflows/deploy-site.yml

```yaml
name: 部署日报展示网站

on:
  push:
    branches: [main]
    paths:
      - '**.md'
      - '.github/workflows/deploy-site.yml'
      - 'scripts/**'
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: pages
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
      - name: 检出代码
        uses: actions/checkout@v4
      
      - name: 设置 Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      
      - name: 安装依赖
        run: npm install
      
      - name: 生成日报索引
        run: node scripts/generate-index.js
      
      - name: 构建网站
        run: npm run build:site
      
      - name: 上传构建产物
        uses: actions/upload-pages-artifact@v3
        with:
          path: site/.vitepress/dist
  
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    
    runs-on: ubuntu-latest
    needs: build
    
    steps:
      - name: 部署到 GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```

## 步骤 5：修改网站配置

编辑 `site/.vitepress/config.ts`，修改以下内容：

```typescript
export default defineConfig({
  title: '我的日报',  // 改成你的标题
  description: '记录每一天的成长',  // 改成你的描述
  
  base: '/daily-reports/',  // 改成你的仓库名
  
  themeConfig: {
    socialLinks: [
      { icon: 'github', link: 'https://github.com/你的用户名/daily-reports' }  // 改成你的链接
    ]
  },
  
  sitemap: {
    hostname: 'https://你的用户名.github.io/daily-reports'  // 改成你的域名
  }
});
```

## 步骤 6：配置 GitHub Pages

1. 进入仓库 Settings → Pages
2. Source 选择 "GitHub Actions"
3. 保存

## 步骤 7：提交并推送

```bash
npm install
git add .
git commit -m "初始化日报仓库"
git push
```

## 步骤 8：配置桌面应用

1. 打开日报桌面应用
2. 点击设置
3. 填写：
   - GitHub Token：你的 Personal Access Token
   - 仓库所有者：你的 GitHub 用户名
   - 仓库名称：daily-reports（你创建的日报仓库名）
   - 分支名称：main

## 完成！

等待 2-3 分钟后，访问：
```
https://你的用户名.github.io/daily-reports/
```

## 目录结构示例

```
daily-reports/
├── .github/
│   └── workflows/
│       └── deploy-site.yml
├── site/
│   ├── .vitepress/
│   │   ├── config.ts
│   │   ├── reports-index.data.ts
│   │   └── stats.data.ts
│   ├── index.md
│   ├── calendar.md
│   ├── archive.md
│   ├── stats.md
│   └── latest.md
├── scripts/
│   └── generate-index.js
├── 2026/
│   └── 02/
│       └── 11.md
├── .gitignore
├── package.json
└── README.md
```

## 常见问题

### Q: 网站显示 404
A: 检查 `site/.vitepress/config.ts` 中的 `base` 是否与仓库名一致

### Q: Actions 失败
A: 检查 GitHub Pages 是否启用，Source 是否选择了 "GitHub Actions"

### Q: 提交日报后网站没更新
A: 等待 2-3 分钟，GitHub Actions 需要时间构建和部署
