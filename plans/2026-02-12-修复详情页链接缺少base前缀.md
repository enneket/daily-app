# 修复详情页链接缺少 base 前缀

## 问题描述

用户反馈详情页链接不正确：
- 当前链接：`https://enneket.github.io/docs/2026/02/12.html`
- 正确链接：`https://enneket.github.io/daily/docs/2026/02/12.html`

缺少了 `/daily` 前缀（VitePress 的 base 路径）。

## 问题原因

在 `scripts/generate-index.js` 中生成日报索引时，`path` 字段直接写死为 `/docs/${year}/${month}/${day}`，没有考虑 VitePress 的 base 配置。

### 当前代码

```javascript
reports.push({
  date,
  year,
  month,
  day,
  title,
  summary,
  timeEntries,
  wordCount,
  path: `/docs/${year}/${month}/${day}`  // ❌ 缺少 base 前缀
});
```

### VitePress 配置

在 `site/.vitepress/config.ts` 中：
```typescript
base: '/daily/',  // 仓库名
```

## 解决方案

### 方案 1：硬编码 base（简单）

直接在生成路径时加上 `/daily` 前缀：

```javascript
path: `/daily/docs/${year}/${month}/${day}`
```

**优点**：简单直接
**缺点**：不够灵活，如果仓库名改变需要修改代码

### 方案 2：从配置读取 base（推荐）

从 VitePress 配置文件读取 base 路径：

```javascript
import config from '../site/.vitepress/config.ts';
const base = config.default.base || '/';
path: `${base}docs/${year}/${month}/${day}`
```

**优点**：灵活，自动适应配置
**缺点**：需要处理 TypeScript 导入

### 方案 3：环境变量

通过环境变量传递 base：

```javascript
const base = process.env.VITE_BASE || '/';
path: `${base}docs/${year}/${month}/${day}`
```

**优点**：灵活，易于配置
**缺点**：需要在 workflow 中设置环境变量

## 实施方案

采用**方案 1**（硬编码），原因：
1. 大多数用户的仓库名就是 `daily`
2. 如果仓库名不同，用户需要修改 VitePress 配置，同时也会注意到这里
3. 简单可靠，不引入额外复杂度

## 修改内容

### 1. 修改 generate-index.js

**文件**：`scripts/generate-index.js`

**修改**：
```javascript
// 修改前
path: `/docs/${year}/${month}/${day}`

// 修改后
path: `/daily/docs/${year}/${month}/${day}`
```

### 2. 更新版本号

- 版本号：v1.2.4
- 更新 `FILE_VERSIONS` 中 `scripts/generate-index.js` 的版本

## 影响范围

- `scripts/generate-index.js` - 修改路径生成逻辑
- `src/main/github-service.ts` - 更新版本号和文件版本

## 测试验证

- [ ] 生成的索引文件中 path 包含 `/daily` 前缀
- [ ] 首页的"最近日报"链接正确
- [ ] 日历页面的日期链接正确
- [ ] 归档页面的日报链接正确
- [ ] 点击链接能正确跳转到详情页

## 用户操作

1. 更新桌面应用到 v1.2.4
2. 点击"保存并初始化"
3. 等待 GitHub Actions 构建完成
4. 刷新网站，测试链接

## 注意事项

### 如果仓库名不是 daily

用户需要同时修改两个地方：
1. `site/.vitepress/config.ts` 中的 `base: '/仓库名/'`
2. `scripts/generate-index.js` 中的 `path: \`/仓库名/docs/...\``

建议在文档中说明这一点。

### 向后兼容

这个修改会影响已有的索引文件，但不影响日报文件本身。用户重新初始化后，链接会自动修复。
